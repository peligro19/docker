# Docker

## Introduction to Docker


### What is Docker?

Docker is an open-source platform that automates the deployment, scaling, and management of applications using containerization. Containers are lightweight, portable, and can run on any system that supports Docker.

## Key Concepts:

1. __Container__: A lightweight, standalone, and executable software package that includes everything needed to run a piece of software, including the code, runtime, libraries, and dependencies.

2. __Image__: A read-only template used to create containers. Images are built from a series of layers.

3. __Dockerfile__: A script containing a set of instructions on how to build a Docker image.

4. __Docker Hub__: A public repository where Docker images are stored and shared.


## Installing Docker

__For Windows and macOS__:

1. Download Docker Desktop from Docker's official website.
2. Run the installer and follow the instructions.
3. After installation, open Docker Desktop to ensure it is running.

__For Linux__:

```sh
# Update existing list of packages
sudo apt-get update

# Install a few prerequisite packages
sudo apt-get install apt-transport-https ca-certificates curl software-properties-common

# Add the GPG key for the official Docker repository
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -

# Add the Docker repository to APT sources
sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

# Update the package database with Docker packages from the newly added repo
sudo apt-get update

# Install Docker
sudo apt-get install docker-ce

# Check Docker version to ensure it's installed
docker --version
```

## Basic Docker Commands

1. __Run a Docker Container__:

    ```sh
    docker run hello-world
    ```

    This command runs a container from the hello-world image, which prints a welcome message.


2. __List Running Containers__:

    ```sh
    docker ps
    ```

3. __List All Containers__:

    ```sh
    docker ps -a
    ```

4. __Stop a Running Container__:

    ```sh
    docker stop <container_id>
    ```


5. __Remove a Container__:

    ```sh
    docker rm <container_id>
    ```

6. __Pull an Image from Docker Hub__:

    ```sh
    docker pull <image_name>
    ```

7. __List Docker Images__:

    ```sh
    docker images
    ```


## Creating a Dockerfile

A Dockerfile is used to create a custom Docker image. Below is an example of a simple Dockerfile for a Python application.

__Dockerfile__:

```sh
# Use an official Python runtime as a parent image
FROM python:3.8-slim-buster

# Set the working directory in the container
WORKDIR /app

# Copy the current directory contents into the container at /app
COPY . /app

# Install any needed packages specified in requirements.txt
RUN pip install --no-cache-dir -r requirements.txt

# Make port 80 available to the world outside this container
EXPOSE 80

# Define environment variable
ENV NAME World

# Run app.py when the container launches
CMD ["python", "app.py"]
```


## Building and Running the Docker Image:

### Build the Docker Image:

```sh
docker build -t my-python-app .
```

### Run the Docker Container:

```sh
docker run -p 4000:80 my-python-app
```

## Docker Compose

Docker Compose is a tool for defining and running multi-container Docker applications.

### __docker-compose.yml__:

```yaml
version: '3'
services:
  web:
    build: .
    ports:
      - "4000:80"
    volumes:
      - .:/app
    environment:
      - FLASK_ENV=development
  redis:
    image: "redis:alpine"
```

### Running Docker Compose:

```sh
docker-compose up
```


## Advanced Docker Concepts

### 1. __Networking__:

* Docker allows you to create custom networks to allow containers to communicate with each other.

```sh
# Create a network
docker network create my_network

# Run a container on the created network
docker run -d --name my_container --network my_network my_image
```

### 2. __Volumes__:

Volumes are used to persist data generated by and used by Docker containers.

```sh
# Create a volume
docker volume create my_volume

# Run a container with the created volume
docker run -d -v my_volume:/app/data my_image
```

### 3. Docker Swarm:

* Docker Swarm is a native clustering and orchestration tool for Docker. It turns a pool of Docker hosts into a single, virtual Docker host.

```sh
# Initialize a swarm
docker swarm init

# Deploy a stack in swarm mode
docker stack deploy -c docker-compose.yml my_stack
```

## Example Project: Deploying a Web Application

### 1. Create a simple web application:

* __app.py:__

    ```python
    from flask import Flask
    app = Flask(__name__)

    @app.route('/')
    def hello_world():
        return 'Hello, Docker!'

    if __name__ == '__main__':
        app.run(host='0.0.0.0', port=80)
    ```

* __requirements.txt__:

    ```python
    Dockerfile: (As shown in the Dockerfile section above)
    ```

### 2. Build and Run the Docker Image:

```sh
docker build -t web-app .
docker run -p 4000:80 web-app
```

### 3. Access the Application:

Open a browser and navigate to `http://localhost:4000` to see the application running.


## Conclusion

Docker is a powerful tool that simplifies the process of deploying and managing applications. By understanding the basic and advanced concepts, along with practical examples, you can leverage Docker to create scalable and maintainable applications.

#### Copyright @ 2024 Sumit Kumar